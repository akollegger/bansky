#!/bin/sh


#REST_URL=http://bansky-server.herokuapp.com/
REST_URL=http://localhost:5000/
CYPHER_URL=${REST_URL}cypher
ACCEPT_TYPE="application/json"
CURL_OPTS="--fail --silent"

CYPHER_PROMPT='(cypher)--> '

cypher() {
  curl ${CURL_OPTS} --data "$1" ${CYPHER_URL} 
  if [ ! $? ]; then echo "Failed"; exit 1; fi
}

if [ "$1" != "" ]; then
  CURL_OPTS="${CURL_OPTS} --header Accept:text/plain"
  cypher "$1"
elif [[ -t 0 ]]; then
  CURL_OPTS="${CURL_OPTS} --header Accept:text/plain"
  printf "$CYPHER_PROMPT"
  while read line; do
    cypher "$line"
    printf "$CYPHER_PROMPT"
  done
  exit 0
else
  CURL_OPTS="${CURL_OPTS} --header Accept:application/json"
  while read line; do
    cypher "$line"
  done
  exit 0
fi
